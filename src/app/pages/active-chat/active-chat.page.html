<ion-content>
  <div class="top-container">
    <ion-row class="top-row">
      <ion-col size-s="2" class="left">
        <ion-button fill="clear" (click)="navigateToChat()">
          <ion-img
            src="../../../assets/svg/icons/back-arrow.svg"
            alt="back-arrow"
          ></ion-img>
        </ion-button>
      </ion-col>

      <ion-col size-s="8" class="middle">
        <h1>Chat</h1>
      </ion-col>
      <ion-col size-s="2" class="right">
        <ion-menu-button></ion-menu-button>
      </ion-col>
    </ion-row>
    <div style="padding-top: 10vh"></div>

    <div class="active-chat">
      <ion-img src="{{ recipient?.profilePic }}" (click)="openProfile()"> </ion-img>
      <h2 class="header-name">
        {{recipient?.firstName}} {{recipient?.lastName}}
      </h2>
    </div>

    <!-- <div class="chat-window-incomming">
      <ion-card>
        <ion-card-header>
          <ion-card-title class="card-title">Konrad Hansen</ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <h2 class="message-content">
            Hej Hanne, jeg vil gerne hjælpe dig med at gå med Fido. Jeg kan gå
            med ham i morgen kl. 12:00. Er det noget du er interesseret i?
          </h2>
          <ion-card-subtitle class="message-time">12:00</ion-card-subtitle>
        </ion-card-content>
      </ion-card>
    </div>

    <div class="chat-window-outgoing">
      <ion-card>
        <ion-card-header>
          <ion-card-title class="card-title">Konrad Hansen</ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <h2 class="message-content">
            Hej Hanne, jeg vil gerne hjælpe dig med at gå med Fido. Jeg kan gå
            med ham i morgen kl. 12:00. Er det noget du er interesseret i?
          </h2>
          <ion-card-subtitle class="message-time">12:00</ion-card-subtitle>
        </ion-card-content>
      </ion-card>
    </div> -->

    <div *ngFor="let message of messages$ | async">
      <div
        [ngClass]="{'chat-window-outgoing': message.userId === currentUser.uid, 'chat-window-incomming': message.userId !== currentUser.uid}"
      >
        <ion-card>
          <ion-card-header>
            <ion-card-title class="card-title"
              >{{ message.userId === currentUser.uid ? 'You' : recipient?.firstName
              }}</ion-card-title
            >
          </ion-card-header>
          <ion-card-content>
            <h2 class="message-content">{{ message.text }}</h2>
            <ion-card-subtitle class="message-time"
              >{{ message.createdAt | date: 'HH:mm' }}</ion-card-subtitle
            >
          </ion-card-content>
        </ion-card>
      </div>
    </div>

    <ion-footer>
      <ion-toolbar>
        <ion-input
          #messageInput
          type="text"
          placeholder="Type a message"
        ></ion-input>
        <ion-button
          slot="end"
          (click)="sendMessage(messageInput.value); messageInput.value=''"
        >
          Send
        </ion-button>
      </ion-toolbar>
    </ion-footer>
  </div>
</ion-content>
